<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>RNG World</title>

<style>
body{
margin:0;
overflow:hidden;
font-family:Arial;
}

/* ===== USERNAME MODAL ===== */

#usernameModal{
position:fixed;
inset:0;
background:rgba(0,0,0,0.95);
display:none;
z-index:999;
justify-content:center;
align-items:center;
}

.username-box{
background:#222;
padding:40px;
border-radius:12px;
text-align:center;
border:3px solid #4caf50;
color:white;
}

.username-box input{
padding:10px;
font-size:18px;
margin-top:10px;
}

.username-box button{
margin-top:20px;
padding:10px 30px;
font-size:18px;
background:#4caf50;
color:white;
border:none;
cursor:pointer;
}

/* ===== STATS BAR ===== */

#stats{
position:fixed;
top:0;
left:0;
width:100%;
background:#000000aa;
color:white;
padding:10px 20px;
font-size:20px;
display:flex;
gap:30px;
z-index:20;
}

/* ===== BUTTONS ===== */

#inventoryBtn,#leaderboardBtn{
position:fixed;
left:20px;
padding:12px 20px;
font-size:18px;
font-weight:bold;
border-radius:8px;
border:3px solid #333;
background:#4caf50;
color:white;
cursor:pointer;
}

#inventoryBtn{top:20px;}
#leaderboardBtn{top:70px;}

/* ===== MODALS ===== */

#inventoryModal,#leaderboardModal{
position:fixed;
inset:0;
background:rgba(0,0,0,0.9);
display:none;
z-index:500;
overflow-y:auto;
padding:20px;
}

.inventory-container{
max-width:900px;
margin:0 auto;
background:#222;
border:3px solid #4caf50;
border-radius:12px;
padding:30px;
color:white;
}

.close-btn{
float:right;
font-size:28px;
cursor:pointer;
}

/* ===== WORLD ===== */

#world{
position:fixed;
inset:0;
background:#1a1a1a;
}

/* ===== WHEEL ===== */

#wheelWrap{
position:fixed;
top:60px;
left:50%;
transform:translateX(-50%);
width:900px;
height:140px;
overflow:hidden;
background:#111;
border:3px solid white;
border-radius:12px;
}

#wheel{display:flex;}

.item{
width:140px;
height:140px;
margin:0 4px;
display:flex;
align-items:center;
justify-content:center;
background:#222;
border-radius:10px;
}

.item img{
width:120px;
height:120px;
border-radius:8px;
}

/* ===== UI ===== */

#pin{
position:fixed;
top:40px;
left:50%;
transform:translateX(-50%);
font-size:50px;
color:red;
}

#ui{
position:fixed;
bottom:30px;
left:50%;
transform:translateX(-50%);
text-align:center;
display:flex;
flex-direction:column;
gap:8px;
}

button{cursor:pointer;}

#spinBtn{
padding:18px 80px;
font-size:28px;
background:#2a2a2a;
color:white;
border-radius:12px;
}

#skipBtn{
padding:10px 45px;
font-size:18px;
background:#2a2a2a;
color:white;
border-radius:12px;
}

#popup{
position:fixed;
top:40%;
left:50%;
transform:translateX(-50%);
font-size:60px;
font-weight:bold;
display:none;
}

#flash{
position:fixed;
inset:0;
opacity:0;
pointer-events:none;
transition:opacity .2s;
}
</style>
</head>

<body>

<!-- USERNAME -->
<div id="usernameModal">
<div class="username-box">
<h2>Enter Username</h2>
<input id="usernameInput" placeholder="Your name">
<br>
<button id="saveUsername">Start</button>
</div>
</div>

<div id="stats">
<div>Total Spins: <span id="s_total">0</span></div>
<div>Common: <span id="s_common">0</span></div>
<div>Rare: <span id="s_rare">0</span></div>
<div>Ultra: <span id="s_ultra">0</span></div>
<div>Mythic: <span id="s_mythic">0</span></div>
<div>Divine: <span id="s_divine">0</span></div>
</div>

<button id="inventoryBtn">üì¶ Inventory</button>
<button id="leaderboardBtn">üèÜ Leaderboard</button>

<!-- INVENTORY -->
<div id="inventoryModal">
<div class="inventory-container">
<span class="close-btn" id="closeInventory">√ó</span>
<h2>Inventory</h2>
<div id="inventoryGrid"></div>
</div>
</div>

<!-- LEADERBOARD -->
<div id="leaderboardModal">
<div class="inventory-container">
<span class="close-btn" id="closeLeaderboard">√ó</span>
<h2>Leaderboard</h2>
<div id="leaderboardList"></div>
</div>
</div>

<div id="world"></div>
<div id="pin">‚ñº</div>

<div id="wheelWrap"><div id="wheel"></div></div>

<div id="ui">
<button id="spinBtn">ROLL</button>
<button id="skipBtn">SKIP</button>
</div>

<div id="popup"></div>
<div id="flash"></div>

<script>

/* USERNAME */

let username="";
function loadUsername(){
let saved=localStorage.getItem("rngWorldUsername");
if(saved){username=saved;}
else document.getElementById("usernameModal").style.display="flex";
}

saveUsername.onclick=()=>{
let name=usernameInput.value.trim();
if(!name)return alert("Enter username");
username=name;
localStorage.setItem("rngWorldUsername",username);
usernameModal.style.display="none";
};

/* STATS */

let stats={total:0,Common:0,Rare:0,Ultra:0,Mythic:0,Divine:0};

function updateStats(){
s_total.innerText=stats.total;
s_common.innerText=stats.Common;
s_rare.innerText=stats.Rare;
s_ultra.innerText=stats.Ultra;
s_mythic.innerText=stats.Mythic;
s_divine.innerText=stats.Divine;
}

/* SAVE PROGRESS */

function loadProgress(){
let s=localStorage.getItem("rngWorldProgress");
if(s) stats=JSON.parse(s);
updateStats();
}
setInterval(()=>localStorage.setItem("rngWorldProgress",JSON.stringify(stats)),5000);

/* INVENTORY */

let inventory={};

function updateInventory(m){
if(!inventory[m.img])inventory[m.img]={...m,count:0};
inventory[m.img].count++;
localStorage.setItem("rngWorldInventory",JSON.stringify(inventory));
}

function loadInventory(){
let s=localStorage.getItem("rngWorldInventory");
if(s)inventory=JSON.parse(s);
}

function displayInventory(){
let html="";
Object.values(inventory).forEach(i=>{
html+=`${i.name} (${i.rarity}) x${i.count}<br>`;
});
inventoryGrid.innerHTML=html||"No items yet";
}

inventoryBtn.onclick=()=>{inventoryModal.style.display="block";displayInventory();}
closeInventory.onclick=()=>inventoryModal.style.display="none";

/* LEADERBOARD */

function updateLeaderboard(){
let board=JSON.parse(localStorage.getItem("rngWorldLeaderboard")||"{}");
board[username]=stats.total;
localStorage.setItem("rngWorldLeaderboard",JSON.stringify(board));
}

function showLeaderboard(){
let board=JSON.parse(localStorage.getItem("rngWorldLeaderboard")||"{}");
let sorted=Object.entries(board).sort((a,b)=>b[1]-a[1]);
leaderboardList.innerHTML=sorted.map((p,i)=>`${i+1}. ${p[0]} ‚Äî ${p[1]} spins`).join("<br>");
}

leaderboardBtn.onclick=()=>{leaderboardModal.style.display="block";showLeaderboard();}
closeLeaderboard.onclick=()=>leaderboardModal.style.display="none";

/* RNG */

const RARITIES=[
{name:"Common",chance:55,color:"#888"},
{name:"Rare",chance:25,color:"#2196f3"},
{name:"Ultra",chance:15,color:"#9c27b0"},
{name:"Mythic",chance:4,color:"#ff9800"},
{name:"Divine",chance:1,color:"#ffd700"}
];

const MEMES=[
{img:"https://i.imgflip.com/30b1gx.jpg",rarity:"Common",name:"Man Look Back"},
{img:"https://i.imgflip.com/1ur9b0.jpg",rarity:"Common",name:"Sad Guy"},
{img:"https://i.imgflip.com/1g8my.jpg",rarity:"Rare",name:"Thinking Guy"},
{img:"https://i.imgflip.com/2hgfw.jpg",rarity:"Ultra",name:"Legend"},
{img:"https://i.imgflip.com/1bij.jpg",rarity:"Mythic",name:"Mythic Being"},
{img:"https://i.imgflip.com/1siru.jpg",rarity:"Divine",name:"Divine Entity"}
];

const wheel=document.getElementById("wheel");

function buildWheel(){
for(let i=0;i<300;i++){
let m=MEMES[i%MEMES.length];
let d=document.createElement("div");
d.className="item";
d.innerHTML=`<img src="${m.img}">`;
wheel.appendChild(d);
}
}
buildWheel();

function pick(){
let r=Math.random()*100,sum=0;
for(let x of RARITIES){
sum+=x.chance;
if(r<=sum){
let pool=MEMES.filter(m=>m.rarity===x.name);
return pool[Math.floor(Math.random()*pool.length)];
}
}
}

/* SPIN */

let spinning=false;

spinBtn.onclick=()=>{
if(spinning)return;
spinning=true;

setTimeout(()=>{
let m=pick();
stats.total++;
stats[m.rarity]++;
updateStats();
updateInventory(m);
updateLeaderboard();
showPopup(m.rarity);
spinning=false;
},1500);
};

skipBtn.onclick=()=>spinning=false;

function showPopup(text){
popup.innerText=text;
popup.style.display="block";
setTimeout(()=>popup.style.display="none",1200);
}

/* INIT */

loadUsername();
loadProgress();
loadInventory();

</script>
</body>
</html>
