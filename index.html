<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Forest World</title>

<style>
body{
    margin:0;
    overflow:hidden;
    background:#87c9ff;
}
canvas{
    display:block;
}
</style>
</head>

<body>
<canvas id="game"></canvas>

<script>
"use strict";

/* =============================
   CANVAS
============================= */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize(){
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

/* =============================
   INPUT
============================= */
const keys = {};
window.addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
window.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

/* =============================
   PLAYER IMAGE
============================= */
const playerImg = new Image();
playerImg.src = "stickman.png"; // <<< PUT YOUR IMAGE NAME HERE

/* =============================
   WORLD
============================= */
const world = {
    gravity: 0.7,
    groundBase: () => canvas.height * 0.78
};

/* =============================
   PLAYER
============================= */
const player = {
    x: 0,
    y: 0,
    vx: 0,
    vy: 0,
    width: 60,
    height: () => canvas.height * 0.55,

    speed: 1.2,
    maxSpeed: 12,
    friction: 0.85,
    jumpPower: 18,
    onGround: false
};

/* =============================
   CAMERA
============================= */
const camera = {
    x: 0,
    smooth: 0.08
};

/* =============================
   BACKGROUND MOUNTAINS + HILLS
============================= */
const mountains = [];
for(let i=0;i<40;i++){
    mountains.push({
        x: i*600,
        height: 150 + Math.random()*250
    });
}

const hills = [];
for(let i=0;i<60;i++){
    hills.push({
        x: i*400,
        height: 60 + Math.random()*100
    });
}

/* =============================
   TREES (random spacing)
============================= */
const trees = [];
let treeX = 0;
for(let i=0;i<200;i++){
    treeX += 150 + Math.random()*300;
    trees.push({
        x: treeX,
        height: 120 + Math.random()*160
    });
}

/* =============================
   ROCK OBSTACLES
============================= */
const rocks = [];
for(let i=0;i<60;i++){
    rocks.push({
        x: i*900 + 500,
        width: 50 + Math.random()*40,
        height: 40 + Math.random()*40
    });
}

/* =============================
   RIVERS + BRIDGES
============================= */
const rivers = [];
for(let i=0;i<25;i++){
    rivers.push({
        x: i*2000 + 1000,
        width: 300 + Math.random()*200,
        bridgeWidth: 180
    });
}

/* =============================
   UPDATE
============================= */
function update(){

    /* MOVEMENT */
    if(keys["a"] || keys["arrowleft"]) player.vx -= player.speed;
    if(keys["d"] || keys["arrowright"]) player.vx += player.speed;

    if((keys["w"] || keys[" "] || keys["arrowup"]) && player.onGround){
        player.vy = -player.jumpPower;
        player.onGround = false;
    }

    player.vx = Math.max(-player.maxSpeed, Math.min(player.maxSpeed, player.vx));
    player.vx *= player.friction;
    player.vy += world.gravity;

    player.x += player.vx;
    player.y += player.vy;

    let ground = world.groundBase();

    /* ROCK COLLISION */
    rocks.forEach(r=>{
        const top = ground - r.height;

        if(
            player.x + player.width > r.x &&
            player.x < r.x + r.width &&
            player.y + player.height() > top &&
            player.vy >= 0
        ){
            player.y = top - player.height();
            player.vy = 0;
            player.onGround = true;
        }
    });

    /* RIVER CHECK */
    let overRiver = false;
    rivers.forEach(rv=>{
        if(player.x + player.width > rv.x && player.x < rv.x + rv.width){
            overRiver = true;

            const bridgeStart = rv.x + rv.width/2 - rv.bridgeWidth/2;
            const bridgeEnd = bridgeStart + rv.bridgeWidth;

            if(player.x + player.width > bridgeStart && player.x < bridgeEnd){
                if(player.y + player.height() > ground - 10){
                    player.y = ground - 10 - player.height();
                    player.vy = 0;
                    player.onGround = true;
                }
            }
        }
    });

    /* NORMAL GROUND */
    if(!overRiver){
        if(player.y + player.height() > ground){
            player.y = ground - player.height();
            player.vy = 0;
            player.onGround = true;
        }
    }

    /* CAMERA */
    const targetCamX = player.x - canvas.width * 0.4;
    camera.x += (targetCamX - camera.x) * camera.smooth;
}

/* =============================
   DRAW SKY
============================= */
function drawSky(){
    ctx.fillStyle = "#87c9ff";
    ctx.fillRect(0,0,canvas.width,canvas.height);
}

/* =============================
   DRAW MOUNTAINS
============================= */
function drawMountains(){
    const ground = world.groundBase();

    ctx.fillStyle = "#6c7a89";
    mountains.forEach(m=>{
        const x = m.x - camera.x*0.3;
        ctx.beginPath();
        ctx.moveTo(x, ground);
        ctx.lineTo(x+300, ground-m.height);
        ctx.lineTo(x+600, ground);
        ctx.fill();
    });
}

/* =============================
   DRAW HILLS
============================= */
function drawHills(){
    const ground = world.groundBase();

    ctx.fillStyle = "#5aa469";
    hills.forEach(h=>{
        const x = h.x - camera.x*0.6;
        ctx.beginPath();
        ctx.arc(x, ground, h.height, Math.PI, 0);
        ctx.fill();
    });
}

/* =============================
   DRAW GROUND
============================= */
function drawGround(){
    const ground = world.groundBase();

    ctx.fillStyle = "#4caf50";
    ctx.fillRect(0, ground, canvas.width, canvas.height-ground);
}

/* =============================
   DRAW TREES
============================= */
function drawTrees(){
    const ground = world.groundBase();

    trees.forEach(t=>{
        const x = t.x - camera.x;

        if(x < -200 || x > canvas.width+200) return;

        ctx.fillStyle = "#6b3f1d";
        ctx.fillRect(x, ground - t.height, 30, t.height);

        ctx.fillStyle = "#2e7d32";
        ctx.beginPath();
        ctx.arc(x+15, ground-t.height, 60, 0, Math.PI*2);
        ctx.fill();
    });
}

/* =============================
   DRAW ROCKS
============================= */
function drawRocks(){
    const ground = world.groundBase();

    ctx.fillStyle = "#777";
    rocks.forEach(r=>{
        const x = r.x - camera.x;
        ctx.fillRect(x, ground-r.height, r.width, r.height);
    });
}

/* =============================
   DRAW RIVERS + BRIDGES
============================= */
function drawRivers(){
    const ground = world.groundBase();

    rivers.forEach(rv=>{
        const x = rv.x - camera.x;

        /* water */
        ctx.fillStyle = "#3fa7ff";
        ctx.fillRect(x, ground, rv.width, 200);

        /* bridge */
        ctx.fillStyle = "#8b5a2b";
        ctx.fillRect(
            x + rv.width/2 - rv.bridgeWidth/2,
            ground - 10,
            rv.bridgeWidth,
            12
        );
    });
}

/* =============================
   DRAW PLAYER IMAGE
============================= */
function drawPlayer(){
    const x = player.x - camera.x;
    ctx.drawImage(
        playerImg,
        x,
        player.y,
        player.width,
        player.height()
    );
}

/* =============================
   LOOP
============================= */
function loop(){
    update();

    drawSky();
    drawMountains();
    drawHills();
    drawGround();
    drawRivers();
    drawTrees();
    drawRocks();
    drawPlayer();

    requestAnimationFrame(loop);
}

/* START */
player.x = 0;
player.y = world.groundBase() - player.height();

loop();

</script>
</body>
</html>
